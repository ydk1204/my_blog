---
title: IOC와 DIP와 DI
date: 2024-01-09
description: IOC와 DIP와 DI을 알아보자
img: /postImg/defaultImg.png
tag: study
note: cs
copyright: https://pixabay.com/ko/users/abdulstudio-16007621/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=5048215
---

---

# IoC(Inversion of Control)

## 제어와 역전
- 제어: 어떠한 클래스 내부에서 **다른 객체를 생성하고 이용**할 때, 직접 코드를 생성해 '제어'한다고 한다.
- 역전: 객체를 클래스 내부에서 직접 생성하고 제어하는 것이 아니라, **외부에서부터 인자로 받아 초기화** 하는 것

## IoC(제어의 역전)가 필요한 이유

IoC는 클래스 내부가 아니라, 클래스 외부에서 제어권을 갖도록 하는 것을 말 한다. <br/>
클래스 외부에서 객체를 생성하기 때문에 **변경이 자유**롭게 가능하다.

예를 들어 우리가 카페에 가서 음료를 주문한다고 가정해보자.

- IoC 적용 X : 여긴 가성비가 좋은 카페다, 가격이 합리적인 대신 주문자가 아메리카노를 시켰을 때 퍼스널 옵션 즉, 기본 그대로 나온다. <br/>
- IoC 적용 O : 여긴 좀 비싸서 그런지 주문자가 아메리카노를 시켰을 때 에스프레소 샷을 몇 번 넣을지, 물의 양 같은 옵션을
              **커스텀** 할 수 있다.

위의 적은 글을 다시 한번 보자. <br/>
IoC는 외부에서 인자를 받아 객체를 생성하고 초기화 하기 때문에 변경이 자유롭고, 그렇지 않은 경우에는
클래스 내부에서 객체를 생성하기 때문에 변경이 자유롭지 못 하다. 그 예시가 위 예시에 적용된 것이다. <br/>

커스텀이 가능한가? 아니면 불가능한가

## IoC 원칙의 좋은점

역할과 책임을 불리하기 때문에 **결합도를 낮추고**, **변경에 유연**한 코드가 될 수 있다.

---

# DIP(Dependency Inversion Principle)

'상위 레벨의 모듈은 하위 헤벨의 모듈에 의존해서는 안 된다. 둘 모두 추상화에 의존해야 한다. 추상화는 세부 사항에 의존해서는 안 된다.'

다시 한번 카페를 가보자. <br/>
이번엔 둘 다 라떼를 시킬건데 만드는 방식이 다르다.

- DIP 적용 X :
  - 이 카페는 라떼를 만들기 위해서 상위레벨(라떼)이 하위레벨(우유 혹은 대체유)에 **의존**하고 있는 상황.
  - 라떼 주문이 들어오면 우유를 먼저 준비하고 그 위에 커피를 부어 라떼를 완성하기 때문에 주문자가 일반 우유에서 두유로 바꾸겠다고 하면 라떼 자체를 **다시 만들어야** 한다.
  - 이를 코드로 바꿔보면 라떼가 특정 된 우유 혹은 대체유에 **의존**하고 있기 때문에(라떼 코드 안에 우유에 대한 코드가 있음),<br/>
  - 라떼에 기본으로 들어가는 우유를 대체유(두유 or 오트)로 바꾸기 위해서는 라떼 자체의 **코드도 바꿔야** 한다.

- DIP 적용 O :
  - 위와 같은 문제를 해결하기 위해 이 카페는 라떼를 만들 때 우유 자체를 준비하는게 아니라 언제든 커피 위에 우유류를 부어 완성 시킬 수 있게했다.
  - "우유 음료를 담을 수 있는 컵"을 준비 해둔 뒤 주문자의 요청에 따라 우유 종류를 재조해 제공한다.
  - 라떼는 특정 우유 자체를 의존하는 것이 아닌 "우유 음료 컵"라는 **interface**를 만들어 의존하도록 하고, 
  - 그 '우유 음료 컵'에 해당될 우유, 저지방, 두유, 오트 등도 "우유 음료 컵"을 의존하도록 한다.
  - 이제 라떼는 무엇을 구체화할지 모를 **추상화**된 "우유 음료 컵"를 의존하고 있고, 어떤 우유가 올지 라떼 컵은 알 필요 없다.
  - 라떼의 우유를 바꾸고 싶다면 라떼 자체의 코드를 바꿀 필요가 없다.

물론 위의 예시는 예시일 뿐이다. 틀린 부분이나 이상한 부분이 존재할 수 있다. <br/>
무엇보다 나는 카페에서 라떼를 만드는 과정을 모른다. 전체적인 흐름 상 어떤 느낌인지만 알아보도록 하자.

이 때 '우유' **interface**는 저수준 모듈인 '특정 우유' 보다 고수준 모듈인 '라떼'에 의해 만들어지는데,<br/>
처음에 라떼가 어떤 우유에 의존했던 상황이 역전되어 어떤 우유에 의존하게 된다고 해서 **'의존 역전 원칙'**이라고 한다.

기존 : 라떼 -> 우유 <br/>
DIP : 우유 -> 라떼

## 잠깐 IoC와 DIP는 차이가 있을까?

IoC와 DIP 모두 **한 클래스의 변경이 다른 클래스에 대해 미치는 영향이 최소**가 되도록, **변경에 유연한 코드**가 되도록 하는 것이 목적이다.

그렇다면 어떤 차이가 있을까?

- IoC는 클래스 **외부에서 인자**를 받아 객체를 **제어**하기 때문에 **변경에 있어 자유**로울 수 있다.
- DIP는 **추상화**를 도입하여 상위 레벨 모듈이 하위 레벨 모듈에 **의존하지 않는다.**

키워드로 보자면,

- IoC = "외부 인자", "변경에 유연함"
- DIP = "추상화", "의존성 역전 혹은 완화"

---

# DI(Dependency Injection)

필요한 객체를 내부에서 정의하는 것이 아닌 외부로 부터 주입받는 방식을 말한다.
... 어디서 한번 본 듯하다?

맞다 바로 IoC의 정의할 때 봤다. 왜 비슷한데 다르게 구분할까?

## IoC와 DI

IoC(Inversion of Control)는 '**원칙**'이다. 그리고 DI(Dependency Injection)는 
이 IoC의 **원칙을 이루기 위한** "디자인 패턴"이다. <br/>
현실로 비유하면 DI는 IoC라는 특별한 방침을 따르는 조직이라고 보면 된다. 

**DI는 IoC의 원칙을 따르는 구체적인 행위**

## DI 패턴

권장되는 의존성 주입 방식에는 3가지가 있다고 한다.

1. 생성자 주입: 필요한 의존성을 모두 포함하는 클래스의 생성자 생성, 그 생성자를 통한 의존성 주입
2. 세터를 통합 주입: 의존성을 입력받는 세터(Setter) 메서드를 만들고, 이 메서드를 통한 의존성 주입
3. **인터페이스**를 통한 주입: 의존성을 주입하는 함수를 포함한 인터페이스를 작성, 이 인터페이스를 구현해서 실행 시에 이를 통해 의존성 주입

## DI와 DIP

이번에는 이름이 비슷하다. 왜일까? <br/>
물론 둘이 같은 것은 아니다. 단지 DI는 DIP를 구현하는 기법 중 하나이다. <br/>
당연히 다른 점이 존재한다.

- DIP는 "**상위 모듈**이 **하위모듈**을 **의존**하면 안 된다.", "**추상화**는 **구체적인 사항에 의존**해선 안 된다."
- DI는 추상화를 해치지 않고 **의존성을 인수로 넘겨**주는 방법이다.

따라서 DI는 DIP의 사용이 필수적이지 않다. 다만 DI는 DIP를 구현하는 방법 중 하나라고 보면 되겠다. <br/>
의존성을 외부에서 주입 받더라도 구체 클래스에 의존하고 있다면 **DI는 사용하고 있지만, DIP는 지켜지지 않는다**고 볼 수 있다. <br/>

이를 예시로 보기 위해, 위에서 자주 갔던 카페를 마지막으로 가보자.

- 이 카페는 가격이 좀 비싸서 그런지 커스텀이 가능하다.
- 라떼를 시키는데 옵션으로 에스프레소 샷을 추가할지도 선택할 수 있는 등의 커스텀이 가능하다.
- 근데 우유 대신 두유로 하겠다고 했더니 직원이 만들던 라떼를 집어 던지고 새로 만들고 있다.

이를 코드로 다시 보자면

- IoC의 원칙이 적용되서 외부로부터 인자를 받아 클래스의 변경이 자유로워졌다(커스텀 가능)
- 하지만 DIP는 적용하지 않아서 추상화의 개념도 없고, 상위 레벨 모듈이 하위 레벨 모듈에 의존하고 있다.

---

이 포스팅을 만들며 참조한 사이트 목록

- [wikipedia][wikipedia]
- [나의 코딩 일지 블로그][나의 코딩 일지 블로그]
- [black-jin블로그][black-jin블로그]
- [vagabond95 블로그][vagabond95 블로그]
- [yoojin99 블로그][yoojin99 블로그]
- [Artur's 블로그][Artur's 블로그]
- [우아한 Tech 유튜브][우아한 Tech 유튜브]

[wikipedia]: https://ko.wikipedia.org/wiki/%EB%94%94%EC%9E%90%EC%9D%B8_%ED%8C%A8%ED%84%B4
[나의 코딩 일지 블로그]: https://my-codinglog.tistory.com/entry/Spring-IoC-DI-와-DIP-이해하기
[black-jin블로그]: https://black-jin0427.tistory.com/194
[vagabond95 블로그]: https://vagabond95.me/posts/about-ioc-dip-di/
[yoojin99 블로그]: https://yoojin99.github.io/cs/Dependency-Inversion-Principle/
[Artur's 블로그]: https://leeseojune53.tistory.com/63
[우아한 Tech 유튜브]: https://www.youtube.com/watch?v=8lp_nHicYd4&feature=youtu.be&themeRefresh=1