{
  "title": "마무리를 지으며",
  "date": "2022-03-21",
  "description": "html",
  "tag": "study",
  "note": "html",
  "body": {
    "raw": "\n## 내 블로그에\n\n벨로그나 다른 개발 블로그를 보면 TOC 가 있는 것을 흔히 볼 수 있다. 직접 사용해 봤을 때 사용 만족도가 최상이었고, 노션을 사용할 때에도 fix된 TOC는 아니지만 긴 문서의 경우 꼭 추가하여 작성하는 편이다.\n\n그래서 블로그 기획 시점부터 TOC 만큼은 반드시 추가해야겠다는 생각이 있었다.\n\n### 어떻게 구현할 것인가?\n\nscroll 이벤트 리스너를 통해 구현할 수도 있겠지만, 스크롤 이벤트의 경우 짧은 시간 내에 수천 수백번의 이벤트가 동기적으로 실행되므로 성능 이슈가 있어 사용하지 않았다.\n\n대신, 이를 보완할 수 있는 InteractionObserver API 를 사용해 구현하기로 한다.\n\n### InteractionObserver API\n\nIntersection Observer API는 타겟 요소와 상위 요소 또는 최상위 document 의 viewport 사이의 intersection 내의 변화를 비동기적으로 관찰하는 방법이다.\nIntersectionObserver는 비동기적으로 실행되기 때문에 스크롤 이벤트와 달리 렌더링 성능 이슈 없이 구현할 수 있다.\n\n## 구현 순서\n\ninterection observer 생성 함수 작성\n생성한 interection observer에 TOC에 표시될 header id 등록\n스크롤에 따른 하이라이팅 처리\nObserver 생성과 등록\ninterection observer를 생성한다. 관찰 대상이 등록되거나 변화가 생기면 callback이 실행되고 옵션을 부여할 수 있다.\n\n```\nconst observer = new IntersectionObserver(callback, options); // 관찰자 초기화(생성)\nobserver.observe(element); // 관찰 대상 등록\nObserver options\nroot\n\n```\n\n### 그냥 하나 추가\n\n설정한 root element 와 관찰 대상의 교차점 여부를 판단\nthreshold\n관찰 대상의 가시성이 얼마나 필요한지 백분율로 표시한다.\n기본 값은 Array타입의 [0], Number 타입의 단일 값 작성도 가능\nrootMargin\nroot elemnet를 기준으릐 바깥 여백(Margin)을 이용해 Root 범위를 설정한다.\n입력 포맷은 css margin 과 같다.\n실전 - 블로그에 등록해보자\nobserver 생성\n컴포넌트에서 호출해서 사용할 수 있도록 getIntersectionObserver 함수를 생성해 IntersectionObserver를 생성한다.\n\n```\nlib/observer.ts\nexport const getIntersectionObserver = () => {\n  const observer = new IntersectionObserver( // observer 생성\n    (entries) => { console.log(entries) }, // callback\n    options // options\n  );\n  return observer;\n};\n```\n\nobserver에 header 등록\nuseState를 사용해 스크롤에 따른 현재 목차와 header 들을 저장할 state를 선언한다.\n\n```\ncomponents/Toc.tsx\nimport { useState } from 'react';\n\nconst Toc = () => {\n  const [currentId, setCurrentId] = useState<string>('');\n  const [headingEls, setHeadingEls] = useState<Element[]>([]);\n  return ...\n}\n\nexport default Toc.\n```\n\nuseEffect를 사용해 컴포넌트가 처음 렌더되면 header elements를 저장하고 observer 의 인자로 setCurrentId 를 넘겨 observer 내에서 현재 목차를 저장하도록 작성할 것이다.\n나는 h2, h3만 표시할 것이므로 headingElements 로 h2, h3 만 저장하고, observer.observe(header)로 header 를 등록한다.\n\n```\ncomponents/Toc.tsx\n  useEffect(() => {\n    const observer = getIntersectionObserver(setCurrentId);\n    const headingElements = Array.from(document.querySelectorAll('h2, h3'));\n\n    setHeadingEls(headingElements);\n\n    headingElements.map((header) => {\n      observer.observe(header);\n    });\n  }, []);\n```\n\n스크롤 방향 체크\n스크롤 방향을 체크할 변수와 함수를 getIntersectionObserver 내에 작성한다.\n\n```\nlib/observer.ts\nimport { Dispatch, SetStateAction } from 'react';\n\nconst observerOption = {\n  threshold: 0.4,\n  rootMargin: '-76px 0px 0px 0px',\n};\n\nexport const getIntersectionObserver = (setState: Dispatch<SetStateAction<string>>) => {\n  let direction = '';\n  let prevYposition = 0;\n\n  // scroll 방향 check function\n  const checkScrollDirection = (prevY: number) => {\n    if (window.scrollY === 0 && prevY === 0) return;\n    else if (window.scrollY > prevY) direction = 'down';\n    else direction = 'up';\n\n    prevYposition = window.scrollY;\n  };\n\n  // observer\n  const observer = new IntersectionObserver((entries) => {\n    entries.forEach((entry) => {\n      checkScrollDirection(prevYposition);\n\n      if ((direction === 'down' && !entry.isIntersecting) ||\n        (direction === 'up' && entry.isIntersecting)) {\n        setState(entry.target.id);\n      }\n    });\n  }, observerOption);\n\n  return observer;\n}\n```\n\nentry.isIntersecting 는 요소의 노출 여부를 boolean 타입으로 반환한다.\n스크롤 방향에 따른 조건부를 작성하고 인자로 전달받은 setState 를 타겟의 id로 저장하여 observer를 return 한다.\n옵션 설정\nrootMargin 은 header 의 높이 만큼 설정했다.\n\n## 이것시 바로 마무리다\n\nㄴ어ㅐㅑ저배ㅑㄹ\nㄹㄴ데ㅐ란데래자데랒ㄷ\nㅈㄷ레ㅐ잗ㅈㄷㄹㅈㄷㄹ잳랒데ㅐ랒ㄷ레잗ㄹ\n\n## 끝난줄 알았지???\n\nㄴ아ㅔ재아메재아\nㄷ라네댈나레ㅐㄴ다ㄴㄴ\n",
    "code": "var Component=(()=>{var sr=Object.create;var D=Object.defineProperty;var ur=Object.getOwnPropertyDescriptor;var dr=Object.getOwnPropertyNames;var cr=Object.getPrototypeOf,fr=Object.prototype.hasOwnProperty;var G=(d,t)=>()=>(t||d((t={exports:{}}).exports,t),t.exports),br=(d,t)=>{for(var p in t)D(d,p,{get:t[p],enumerable:!0})},xe=(d,t,p,y)=>{if(t&&typeof t==\"object\"||typeof t==\"function\")for(let g of dr(t))!fr.call(d,g)&&g!==p&&D(d,g,{get:()=>t[g],enumerable:!(y=ur(t,g))||y.enumerable});return d};var mr=(d,t,p)=>(p=d!=null?sr(cr(d)):{},xe(t||!d||!d.__esModule?D(p,\"default\",{value:d,enumerable:!0}):p,d)),_r=d=>xe(D({},\"__esModule\",{value:!0}),d);var Ne=G((xr,Ee)=>{Ee.exports=React});var Re=G(z=>{\"use strict\";(function(){\"use strict\";var d=Ne(),t=Symbol.for(\"react.element\"),p=Symbol.for(\"react.portal\"),y=Symbol.for(\"react.fragment\"),g=Symbol.for(\"react.strict_mode\"),H=Symbol.for(\"react.profiler\"),X=Symbol.for(\"react.provider\"),K=Symbol.for(\"react.context\"),k=Symbol.for(\"react.forward_ref\"),A=Symbol.for(\"react.suspense\"),F=Symbol.for(\"react.suspense_list\"),T=Symbol.for(\"react.memo\"),Y=Symbol.for(\"react.lazy\"),Te=Symbol.for(\"react.offscreen\"),J=Symbol.iterator,we=\"@@iterator\";function Ce(e){if(e===null||typeof e!=\"object\")return null;var r=J&&e[J]||e[we];return typeof r==\"function\"?r:null}var E=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function b(e){{for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];Se(\"error\",e,n)}}function Se(e,r,n){{var o=E.ReactDebugCurrentFrame,s=o.getStackAddendum();s!==\"\"&&(r+=\"%s\",n=n.concat([s]));var u=n.map(function(l){return String(l)});u.unshift(\"Warning: \"+r),Function.prototype.apply.call(console[e],console,u)}}var Pe=!1,Ie=!1,De=!1,Ae=!1,Fe=!1,Z;Z=Symbol.for(\"react.module.reference\");function Ye(e){return!!(typeof e==\"string\"||typeof e==\"function\"||e===y||e===H||Fe||e===g||e===A||e===F||Ae||e===Te||Pe||Ie||De||typeof e==\"object\"&&e!==null&&(e.$$typeof===Y||e.$$typeof===T||e.$$typeof===X||e.$$typeof===K||e.$$typeof===k||e.$$typeof===Z||e.getModuleId!==void 0))}function Me(e,r,n){var o=e.displayName;if(o)return o;var s=r.displayName||r.name||\"\";return s!==\"\"?n+\"(\"+s+\")\":n}function Q(e){return e.displayName||\"Context\"}function h(e){if(e==null)return null;if(typeof e.tag==\"number\"&&b(\"Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue.\"),typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case y:return\"Fragment\";case p:return\"Portal\";case H:return\"Profiler\";case g:return\"StrictMode\";case A:return\"Suspense\";case F:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case K:var r=e;return Q(r)+\".Consumer\";case X:var n=e;return Q(n._context)+\".Provider\";case k:return Me(e,e.render,\"ForwardRef\");case T:var o=e.displayName||null;return o!==null?o:h(e.type)||\"Memo\";case Y:{var s=e,u=s._payload,l=s._init;try{return h(l(u))}catch{return null}}}return null}var x=Object.assign,j=0,ee,re,ne,te,oe,ae,ie;function le(){}le.__reactDisabledLog=!0;function $e(){{if(j===0){ee=console.log,re=console.info,ne=console.warn,te=console.error,oe=console.group,ae=console.groupCollapsed,ie=console.groupEnd;var e={configurable:!0,enumerable:!0,value:le,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}j++}}function We(){{if(j--,j===0){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:x({},e,{value:ee}),info:x({},e,{value:re}),warn:x({},e,{value:ne}),error:x({},e,{value:te}),group:x({},e,{value:oe}),groupCollapsed:x({},e,{value:ae}),groupEnd:x({},e,{value:ie})})}j<0&&b(\"disabledDepth fell below zero. This is a bug in React. Please file an issue.\")}}var M=E.ReactCurrentDispatcher,$;function w(e,r,n){{if($===void 0)try{throw Error()}catch(s){var o=s.stack.trim().match(/\\n( *(at )?)/);$=o&&o[1]||\"\"}return`\n`+$+e}}var W=!1,C;{var Ve=typeof WeakMap==\"function\"?WeakMap:Map;C=new Ve}function se(e,r){if(!e||W)return\"\";{var n=C.get(e);if(n!==void 0)return n}var o;W=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var u;u=M.current,M.current=null,$e();try{if(r){var l=function(){throw Error()};if(Object.defineProperty(l.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(l,[])}catch(v){o=v}Reflect.construct(e,[],l)}else{try{l.call()}catch(v){o=v}e.call(l.prototype)}}else{try{throw Error()}catch(v){o=v}e()}}catch(v){if(v&&o&&typeof v.stack==\"string\"){for(var a=v.stack.split(`\n`),m=o.stack.split(`\n`),c=a.length-1,f=m.length-1;c>=1&&f>=0&&a[c]!==m[f];)f--;for(;c>=1&&f>=0;c--,f--)if(a[c]!==m[f]){if(c!==1||f!==1)do if(c--,f--,f<0||a[c]!==m[f]){var _=`\n`+a[c].replace(\" at new \",\" at \");return e.displayName&&_.includes(\"<anonymous>\")&&(_=_.replace(\"<anonymous>\",e.displayName)),typeof e==\"function\"&&C.set(e,_),_}while(c>=1&&f>=0);break}}}finally{W=!1,M.current=u,We(),Error.prepareStackTrace=s}var R=e?e.displayName||e.name:\"\",ye=R?w(R):\"\";return typeof e==\"function\"&&C.set(e,ye),ye}function Le(e,r,n){return se(e,!1)}function Ue(e){var r=e.prototype;return!!(r&&r.isReactComponent)}function S(e,r,n){if(e==null)return\"\";if(typeof e==\"function\")return se(e,Ue(e));if(typeof e==\"string\")return w(e);switch(e){case A:return w(\"Suspense\");case F:return w(\"SuspenseList\")}if(typeof e==\"object\")switch(e.$$typeof){case k:return Le(e.render);case T:return S(e.type,r,n);case Y:{var o=e,s=o._payload,u=o._init;try{return S(u(s),r,n)}catch{}}}return\"\"}var P=Object.prototype.hasOwnProperty,ue={},de=E.ReactDebugCurrentFrame;function I(e){if(e){var r=e._owner,n=S(e.type,e._source,r?r.type:null);de.setExtraStackFrame(n)}else de.setExtraStackFrame(null)}function Be(e,r,n,o,s){{var u=Function.call.bind(P);for(var l in e)if(u(e,l)){var a=void 0;try{if(typeof e[l]!=\"function\"){var m=Error((o||\"React class\")+\": \"+n+\" type `\"+l+\"` is invalid; it must be a function, usually from the `prop-types` package, but received `\"+typeof e[l]+\"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.\");throw m.name=\"Invariant Violation\",m}a=e[l](r,l,o,n,null,\"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED\")}catch(c){a=c}a&&!(a instanceof Error)&&(I(s),b(\"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).\",o||\"React class\",n,l,typeof a),I(null)),a instanceof Error&&!(a.message in ue)&&(ue[a.message]=!0,I(s),b(\"Failed %s type: %s\",n,a.message),I(null))}}}var qe=Array.isArray;function V(e){return qe(e)}function Ge(e){{var r=typeof Symbol==\"function\"&&Symbol.toStringTag,n=r&&e[Symbol.toStringTag]||e.constructor.name||\"Object\";return n}}function ze(e){try{return ce(e),!1}catch{return!0}}function ce(e){return\"\"+e}function fe(e){if(ze(e))return b(\"The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.\",Ge(e)),ce(e)}var O=E.ReactCurrentOwner,He={key:!0,ref:!0,__self:!0,__source:!0},be,me,L;L={};function Xe(e){if(P.call(e,\"ref\")){var r=Object.getOwnPropertyDescriptor(e,\"ref\").get;if(r&&r.isReactWarning)return!1}return e.ref!==void 0}function Ke(e){if(P.call(e,\"key\")){var r=Object.getOwnPropertyDescriptor(e,\"key\").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function Je(e,r){if(typeof e.ref==\"string\"&&O.current&&r&&O.current.stateNode!==r){var n=h(O.current.type);L[n]||(b('Component \"%s\" contains the string ref \"%s\". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',h(O.current.type),e.ref),L[n]=!0)}}function Ze(e,r){{var n=function(){be||(be=!0,b(\"%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",r))};n.isReactWarning=!0,Object.defineProperty(e,\"key\",{get:n,configurable:!0})}}function Qe(e,r){{var n=function(){me||(me=!0,b(\"%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)\",r))};n.isReactWarning=!0,Object.defineProperty(e,\"ref\",{get:n,configurable:!0})}}var er=function(e,r,n,o,s,u,l){var a={$$typeof:t,type:e,key:r,ref:n,props:l,_owner:u};return a._store={},Object.defineProperty(a._store,\"validated\",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(a,\"_self\",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(a,\"_source\",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(a.props),Object.freeze(a)),a};function rr(e,r,n,o,s){{var u,l={},a=null,m=null;n!==void 0&&(fe(n),a=\"\"+n),Ke(r)&&(fe(r.key),a=\"\"+r.key),Xe(r)&&(m=r.ref,Je(r,s));for(u in r)P.call(r,u)&&!He.hasOwnProperty(u)&&(l[u]=r[u]);if(e&&e.defaultProps){var c=e.defaultProps;for(u in c)l[u]===void 0&&(l[u]=c[u])}if(a||m){var f=typeof e==\"function\"?e.displayName||e.name||\"Unknown\":e;a&&Ze(l,f),m&&Qe(l,f)}return er(e,a,m,s,o,O.current,l)}}var U=E.ReactCurrentOwner,_e=E.ReactDebugCurrentFrame;function N(e){if(e){var r=e._owner,n=S(e.type,e._source,r?r.type:null);_e.setExtraStackFrame(n)}else _e.setExtraStackFrame(null)}var B;B=!1;function q(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===t}function pe(){{if(U.current){var e=h(U.current.type);if(e)return`\n\nCheck the render method of \\``+e+\"`.\"}return\"\"}}function nr(e){{if(e!==void 0){var r=e.fileName.replace(/^.*[\\\\\\/]/,\"\"),n=e.lineNumber;return`\n\nCheck your code at `+r+\":\"+n+\".\"}return\"\"}}var he={};function tr(e){{var r=pe();if(!r){var n=typeof e==\"string\"?e:e.displayName||e.name;n&&(r=`\n\nCheck the top-level render call using <`+n+\">.\")}return r}}function ve(e,r){{if(!e._store||e._store.validated||e.key!=null)return;e._store.validated=!0;var n=tr(r);if(he[n])return;he[n]=!0;var o=\"\";e&&e._owner&&e._owner!==U.current&&(o=\" It was passed a child from \"+h(e._owner.type)+\".\"),N(e),b('Each child in a list should have a unique \"key\" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,o),N(null)}}function ge(e,r){{if(typeof e!=\"object\")return;if(V(e))for(var n=0;n<e.length;n++){var o=e[n];q(o)&&ve(o,r)}else if(q(e))e._store&&(e._store.validated=!0);else if(e){var s=Ce(e);if(typeof s==\"function\"&&s!==e.entries)for(var u=s.call(e),l;!(l=u.next()).done;)q(l.value)&&ve(l.value,r)}}}function or(e){{var r=e.type;if(r==null||typeof r==\"string\")return;var n;if(typeof r==\"function\")n=r.propTypes;else if(typeof r==\"object\"&&(r.$$typeof===k||r.$$typeof===T))n=r.propTypes;else return;if(n){var o=h(r);Be(n,e.props,\"prop\",o,e)}else if(r.PropTypes!==void 0&&!B){B=!0;var s=h(r);b(\"Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?\",s||\"Unknown\")}typeof r.getDefaultProps==\"function\"&&!r.getDefaultProps.isReactClassApproved&&b(\"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.\")}}function ar(e){{for(var r=Object.keys(e.props),n=0;n<r.length;n++){var o=r[n];if(o!==\"children\"&&o!==\"key\"){N(e),b(\"Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.\",o),N(null);break}}e.ref!==null&&(N(e),b(\"Invalid attribute `ref` supplied to `React.Fragment`.\"),N(null))}}function ir(e,r,n,o,s,u){{var l=Ye(e);if(!l){var a=\"\";(e===void 0||typeof e==\"object\"&&e!==null&&Object.keys(e).length===0)&&(a+=\" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports.\");var m=nr(s);m?a+=m:a+=pe();var c;e===null?c=\"null\":V(e)?c=\"array\":e!==void 0&&e.$$typeof===t?(c=\"<\"+(h(e.type)||\"Unknown\")+\" />\",a=\" Did you accidentally export a JSX literal instead of a component?\"):c=typeof e,b(\"React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s\",c,a)}var f=rr(e,r,n,s,u);if(f==null)return f;if(l){var _=r.children;if(_!==void 0)if(o)if(V(_)){for(var R=0;R<_.length;R++)ge(_[R],e);Object.freeze&&Object.freeze(_)}else b(\"React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.\");else ge(_,e)}return e===y?ar(f):or(f),f}}var lr=ir;z.Fragment=y,z.jsxDEV=lr})()});var Oe=G((Nr,je)=>{\"use strict\";je.exports=Re()});var gr={};br(gr,{default:()=>vr,frontmatter:()=>pr});var i=mr(Oe()),pr={title:\"\\uB9C8\\uBB34\\uB9AC\\uB97C \\uC9C0\\uC73C\\uBA70\",date:new Date(16478208e5),description:\"html\",tag:\"study\",note:\"html\"};function ke(d){let t=Object.assign({h2:\"h2\",p:\"p\",h3:\"h3\",pre:\"pre\",code:\"code\"},d.components);return(0,i.jsxDEV)(i.Fragment,{children:[(0,i.jsxDEV)(t.h2,{children:\"\\uB0B4 \\uBE14\\uB85C\\uADF8\\uC5D0\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:9,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:\"\\uBCA8\\uB85C\\uADF8\\uB098 \\uB2E4\\uB978 \\uAC1C\\uBC1C \\uBE14\\uB85C\\uADF8\\uB97C \\uBCF4\\uBA74 TOC \\uAC00 \\uC788\\uB294 \\uAC83\\uC744 \\uD754\\uD788 \\uBCFC \\uC218 \\uC788\\uB2E4. \\uC9C1\\uC811 \\uC0AC\\uC6A9\\uD574 \\uBD24\\uC744 \\uB54C \\uC0AC\\uC6A9 \\uB9CC\\uC871\\uB3C4\\uAC00 \\uCD5C\\uC0C1\\uC774\\uC5C8\\uACE0, \\uB178\\uC158\\uC744 \\uC0AC\\uC6A9\\uD560 \\uB54C\\uC5D0\\uB3C4 fix\\uB41C TOC\\uB294 \\uC544\\uB2C8\\uC9C0\\uB9CC \\uAE34 \\uBB38\\uC11C\\uC758 \\uACBD\\uC6B0 \\uAF2D \\uCD94\\uAC00\\uD558\\uC5EC \\uC791\\uC131\\uD558\\uB294 \\uD3B8\\uC774\\uB2E4.\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:11,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:\"\\uADF8\\uB798\\uC11C \\uBE14\\uB85C\\uADF8 \\uAE30\\uD68D \\uC2DC\\uC810\\uBD80\\uD130 TOC \\uB9CC\\uD07C\\uC740 \\uBC18\\uB4DC\\uC2DC \\uCD94\\uAC00\\uD574\\uC57C\\uACA0\\uB2E4\\uB294 \\uC0DD\\uAC01\\uC774 \\uC788\\uC5C8\\uB2E4.\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:13,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h3,{children:\"\\uC5B4\\uB5BB\\uAC8C \\uAD6C\\uD604\\uD560 \\uAC83\\uC778\\uAC00?\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:15,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:\"scroll \\uC774\\uBCA4\\uD2B8 \\uB9AC\\uC2A4\\uB108\\uB97C \\uD1B5\\uD574 \\uAD6C\\uD604\\uD560 \\uC218\\uB3C4 \\uC788\\uACA0\\uC9C0\\uB9CC, \\uC2A4\\uD06C\\uB864 \\uC774\\uBCA4\\uD2B8\\uC758 \\uACBD\\uC6B0 \\uC9E7\\uC740 \\uC2DC\\uAC04 \\uB0B4\\uC5D0 \\uC218\\uCC9C \\uC218\\uBC31\\uBC88\\uC758 \\uC774\\uBCA4\\uD2B8\\uAC00 \\uB3D9\\uAE30\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uB418\\uBBC0\\uB85C \\uC131\\uB2A5 \\uC774\\uC288\\uAC00 \\uC788\\uC5B4 \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uC558\\uB2E4.\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:17,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:\"\\uB300\\uC2E0, \\uC774\\uB97C \\uBCF4\\uC644\\uD560 \\uC218 \\uC788\\uB294 InteractionObserver API \\uB97C \\uC0AC\\uC6A9\\uD574 \\uAD6C\\uD604\\uD558\\uAE30\\uB85C \\uD55C\\uB2E4.\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:19,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h3,{children:\"InteractionObserver API\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:21,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`Intersection Observer API\\uB294 \\uD0C0\\uAC9F \\uC694\\uC18C\\uC640 \\uC0C1\\uC704 \\uC694\\uC18C \\uB610\\uB294 \\uCD5C\\uC0C1\\uC704 document \\uC758 viewport \\uC0AC\\uC774\\uC758 intersection \\uB0B4\\uC758 \\uBCC0\\uD654\\uB97C \\uBE44\\uB3D9\\uAE30\\uC801\\uC73C\\uB85C \\uAD00\\uCC30\\uD558\\uB294 \\uBC29\\uBC95\\uC774\\uB2E4.\nIntersectionObserver\\uB294 \\uBE44\\uB3D9\\uAE30\\uC801\\uC73C\\uB85C \\uC2E4\\uD589\\uB418\\uAE30 \\uB54C\\uBB38\\uC5D0 \\uC2A4\\uD06C\\uB864 \\uC774\\uBCA4\\uD2B8\\uC640 \\uB2EC\\uB9AC \\uB80C\\uB354\\uB9C1 \\uC131\\uB2A5 \\uC774\\uC288 \\uC5C6\\uC774 \\uAD6C\\uD604\\uD560 \\uC218 \\uC788\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:23,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h2,{children:\"\\uAD6C\\uD604 \\uC21C\\uC11C\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:26,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`interection observer \\uC0DD\\uC131 \\uD568\\uC218 \\uC791\\uC131\n\\uC0DD\\uC131\\uD55C interection observer\\uC5D0 TOC\\uC5D0 \\uD45C\\uC2DC\\uB420 header id \\uB4F1\\uB85D\n\\uC2A4\\uD06C\\uB864\\uC5D0 \\uB530\\uB978 \\uD558\\uC774\\uB77C\\uC774\\uD305 \\uCC98\\uB9AC\nObserver \\uC0DD\\uC131\\uACFC \\uB4F1\\uB85D\ninterection observer\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4. \\uAD00\\uCC30 \\uB300\\uC0C1\\uC774 \\uB4F1\\uB85D\\uB418\\uAC70\\uB098 \\uBCC0\\uD654\\uAC00 \\uC0DD\\uAE30\\uBA74 callback\\uC774 \\uC2E4\\uD589\\uB418\\uACE0 \\uC635\\uC158\\uC744 \\uBD80\\uC5EC\\uD560 \\uC218 \\uC788\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:28,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.pre,{children:(0,i.jsxDEV)(t.code,{children:`const observer = new IntersectionObserver(callback, options); // \\uAD00\\uCC30\\uC790 \\uCD08\\uAE30\\uD654(\\uC0DD\\uC131)\nobserver.observe(element); // \\uAD00\\uCC30 \\uB300\\uC0C1 \\uB4F1\\uB85D\nObserver options\nroot\n\n`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:34,columnNumber:1},this)},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:34,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h3,{children:\"\\uADF8\\uB0E5 \\uD558\\uB098 \\uCD94\\uAC00\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:42,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`\\uC124\\uC815\\uD55C root element \\uC640 \\uAD00\\uCC30 \\uB300\\uC0C1\\uC758 \\uAD50\\uCC28\\uC810 \\uC5EC\\uBD80\\uB97C \\uD310\\uB2E8\nthreshold\n\\uAD00\\uCC30 \\uB300\\uC0C1\\uC758 \\uAC00\\uC2DC\\uC131\\uC774 \\uC5BC\\uB9C8\\uB098 \\uD544\\uC694\\uD55C\\uC9C0 \\uBC31\\uBD84\\uC728\\uB85C \\uD45C\\uC2DC\\uD55C\\uB2E4.\n\\uAE30\\uBCF8 \\uAC12\\uC740 Array\\uD0C0\\uC785\\uC758 [0], Number \\uD0C0\\uC785\\uC758 \\uB2E8\\uC77C \\uAC12 \\uC791\\uC131\\uB3C4 \\uAC00\\uB2A5\nrootMargin\nroot elemnet\\uB97C \\uAE30\\uC900\\uC73C\\uB990 \\uBC14\\uAE65 \\uC5EC\\uBC31(Margin)\\uC744 \\uC774\\uC6A9\\uD574 Root \\uBC94\\uC704\\uB97C \\uC124\\uC815\\uD55C\\uB2E4.\n\\uC785\\uB825 \\uD3EC\\uB9F7\\uC740 css margin \\uACFC \\uAC19\\uB2E4.\n\\uC2E4\\uC804 - \\uBE14\\uB85C\\uADF8\\uC5D0 \\uB4F1\\uB85D\\uD574\\uBCF4\\uC790\nobserver \\uC0DD\\uC131\n\\uCEF4\\uD3EC\\uB10C\\uD2B8\\uC5D0\\uC11C \\uD638\\uCD9C\\uD574\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D getIntersectionObserver \\uD568\\uC218\\uB97C \\uC0DD\\uC131\\uD574 IntersectionObserver\\uB97C \\uC0DD\\uC131\\uD55C\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:44,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.pre,{children:(0,i.jsxDEV)(t.code,{children:`lib/observer.ts\nexport const getIntersectionObserver = () => {\n  const observer = new IntersectionObserver( // observer \\uC0DD\\uC131\n    (entries) => { console.log(entries) }, // callback\n    options // options\n  );\n  return observer;\n};\n`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:55,columnNumber:1},this)},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:55,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`observer\\uC5D0 header \\uB4F1\\uB85D\nuseState\\uB97C \\uC0AC\\uC6A9\\uD574 \\uC2A4\\uD06C\\uB864\\uC5D0 \\uB530\\uB978 \\uD604\\uC7AC \\uBAA9\\uCC28\\uC640 header \\uB4E4\\uC744 \\uC800\\uC7A5\\uD560 state\\uB97C \\uC120\\uC5B8\\uD55C\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:66,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.pre,{children:(0,i.jsxDEV)(t.code,{children:`components/Toc.tsx\nimport { useState } from 'react';\n\nconst Toc = () => {\n  const [currentId, setCurrentId] = useState<string>('');\n  const [headingEls, setHeadingEls] = useState<Element[]>([]);\n  return ...\n}\n\nexport default Toc.\n`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:69,columnNumber:1},this)},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:69,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`useEffect\\uB97C \\uC0AC\\uC6A9\\uD574 \\uCEF4\\uD3EC\\uB10C\\uD2B8\\uAC00 \\uCC98\\uC74C \\uB80C\\uB354\\uB418\\uBA74 header elements\\uB97C \\uC800\\uC7A5\\uD558\\uACE0 observer \\uC758 \\uC778\\uC790\\uB85C setCurrentId \\uB97C \\uB118\\uACA8 observer \\uB0B4\\uC5D0\\uC11C \\uD604\\uC7AC \\uBAA9\\uCC28\\uB97C \\uC800\\uC7A5\\uD558\\uB3C4\\uB85D \\uC791\\uC131\\uD560 \\uAC83\\uC774\\uB2E4.\n\\uB098\\uB294 h2, h3\\uB9CC \\uD45C\\uC2DC\\uD560 \\uAC83\\uC774\\uBBC0\\uB85C headingElements \\uB85C h2, h3 \\uB9CC \\uC800\\uC7A5\\uD558\\uACE0, observer.observe(header)\\uB85C header \\uB97C \\uB4F1\\uB85D\\uD55C\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:82,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.pre,{children:(0,i.jsxDEV)(t.code,{children:`components/Toc.tsx\n  useEffect(() => {\n    const observer = getIntersectionObserver(setCurrentId);\n    const headingElements = Array.from(document.querySelectorAll('h2, h3'));\n\n    setHeadingEls(headingElements);\n\n    headingElements.map((header) => {\n      observer.observe(header);\n    });\n  }, []);\n`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:85,columnNumber:1},this)},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:85,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`\\uC2A4\\uD06C\\uB864 \\uBC29\\uD5A5 \\uCCB4\\uD06C\n\\uC2A4\\uD06C\\uB864 \\uBC29\\uD5A5\\uC744 \\uCCB4\\uD06C\\uD560 \\uBCC0\\uC218\\uC640 \\uD568\\uC218\\uB97C getIntersectionObserver \\uB0B4\\uC5D0 \\uC791\\uC131\\uD55C\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:99,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.pre,{children:(0,i.jsxDEV)(t.code,{children:`lib/observer.ts\nimport { Dispatch, SetStateAction } from 'react';\n\nconst observerOption = {\n  threshold: 0.4,\n  rootMargin: '-76px 0px 0px 0px',\n};\n\nexport const getIntersectionObserver = (setState: Dispatch<SetStateAction<string>>) => {\n  let direction = '';\n  let prevYposition = 0;\n\n  // scroll \\uBC29\\uD5A5 check function\n  const checkScrollDirection = (prevY: number) => {\n    if (window.scrollY === 0 && prevY === 0) return;\n    else if (window.scrollY > prevY) direction = 'down';\n    else direction = 'up';\n\n    prevYposition = window.scrollY;\n  };\n\n  // observer\n  const observer = new IntersectionObserver((entries) => {\n    entries.forEach((entry) => {\n      checkScrollDirection(prevYposition);\n\n      if ((direction === 'down' && !entry.isIntersecting) ||\n        (direction === 'up' && entry.isIntersecting)) {\n        setState(entry.target.id);\n      }\n    });\n  }, observerOption);\n\n  return observer;\n}\n`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:102,columnNumber:1},this)},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:102,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`entry.isIntersecting \\uB294 \\uC694\\uC18C\\uC758 \\uB178\\uCD9C \\uC5EC\\uBD80\\uB97C boolean \\uD0C0\\uC785\\uC73C\\uB85C \\uBC18\\uD658\\uD55C\\uB2E4.\n\\uC2A4\\uD06C\\uB864 \\uBC29\\uD5A5\\uC5D0 \\uB530\\uB978 \\uC870\\uAC74\\uBD80\\uB97C \\uC791\\uC131\\uD558\\uACE0 \\uC778\\uC790\\uB85C \\uC804\\uB2EC\\uBC1B\\uC740 setState \\uB97C \\uD0C0\\uAC9F\\uC758 id\\uB85C \\uC800\\uC7A5\\uD558\\uC5EC observer\\uB97C return \\uD55C\\uB2E4.\n\\uC635\\uC158 \\uC124\\uC815\nrootMargin \\uC740 header \\uC758 \\uB192\\uC774 \\uB9CC\\uD07C \\uC124\\uC815\\uD588\\uB2E4.`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:140,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h2,{children:\"\\uC774\\uAC83\\uC2DC \\uBC14\\uB85C \\uB9C8\\uBB34\\uB9AC\\uB2E4\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:145,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`\\u3134\\uC5B4\\u3150\\u3151\\uC800\\uBC30\\u3151\\u3139\n\\u3139\\u3134\\uB370\\u3150\\uB780\\uB370\\uB798\\uC790\\uB370\\uB792\\u3137\n\\u3148\\u3137\\uB808\\u3150\\uC797\\u3148\\u3137\\u3139\\u3148\\u3137\\u3139\\uC7B3\\uB792\\uB370\\u3150\\uB792\\u3137\\uB808\\uC797\\u3139`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:147,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.h2,{children:\"\\uB05D\\uB09C\\uC904 \\uC54C\\uC558\\uC9C0???\"},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:151,columnNumber:1},this),`\n`,(0,i.jsxDEV)(t.p,{children:`\\u3134\\uC544\\u3154\\uC7AC\\uC544\\uBA54\\uC7AC\\uC544\n\\u3137\\uB77C\\uB124\\uB308\\uB098\\uB808\\u3150\\u3134\\uB2E4\\u3134\\u3134`},void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:153,columnNumber:1},this)]},void 0,!0,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\",lineNumber:1,columnNumber:1},this)}function hr(d={}){let{wrapper:t}=d.components||{};return t?(0,i.jsxDEV)(t,Object.assign({},d,{children:(0,i.jsxDEV)(ke,d,void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\"},this)}),void 0,!1,{fileName:\"/home/ydk/blog_proejct/my_blog/posts/_mdx_bundler_entry_point-f0090e5b-eb95-4178-bdee-b2a43abd61e6.mdx\"},this):ke(d)}var vr=hr;return _r(gr);})();\n/*! Bundled license information:\n\nreact/cjs/react-jsx-dev-runtime.development.js:\n  (**\n   * @license React\n   * react-jsx-dev-runtime.development.js\n   *\n   * Copyright (c) Facebook, Inc. and its affiliates.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   *)\n*/\n;return Component;"
  },
  "_id": "마무리.mdx",
  "_raw": {
    "sourceFilePath": "마무리.mdx",
    "sourceFileName": "마무리.mdx",
    "sourceFileDir": ".",
    "contentType": "mdx",
    "flattenedPath": "마무리"
  },
  "type": "Post"
}